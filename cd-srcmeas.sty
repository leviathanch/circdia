% cd-srcmeas.sty
% from http://www.taylorgruppe.de/circdia/
% File created by Stefan Krause -- version 1.5.
% Supports additional source and measurement symbols for circdia.sty.
% Other sources
\newcommand{\othersrc}[7][]{
 \prepareelement{UI}{#2}{#5}{#6}{#7}
 \begin{scope}[shift = {(#3, #4)}]
  \expandafter\csname othersrc\cdorient\endcsname{#1}
  \drawrefval
 \end{scope}
}
\newcommand{\othersrcH}[1]{
 \setstandardtextpos{ud}
 \ifthenelse{\equal{\cdtype}{o}}{
  \placerefvalH{-2.25}{0}{2.25}{-3.25}{0}{3.25}
  #1
  \draw [cdmedlines] circle (2);
  \draw (-2, 0) -- (-3, 0) (2, 0) -- (3, 0);
 }{}
 \ifthenelse{\equal{\cdtype}{oo}}{
  \placerefvalH{-2.5}{0}{2.5}{-3}{0}{3}
  #1
  \draw [cdmedlines] (-0.8, 0) circle (1.6) (0.8, 0) circle (1.6);
  \draw (-2.4, 0) -- (-3, 0) (2.4, 0) -- (3, 0);
 }{}
 \ifthenelse{\equal{\cdtype}{()}}{
  \placerefvalH{-2.25}{0}{2.25}{-3.25}{0}{3.25}
  #1
  \draw [cdmedlines] (-0.4, 1.8) arc (90 : 270 : 1.8) (0.4, -1.8) arc (-90 : 90 : 1.8);
  \draw (-2.2, 0) -- (-3, 0) (2.2, 0) -- (3, 0);
 }{}
}
\newcommand{\othersrcL}[1]{
 \setstandardtextpos{ud}
 \ifthenelse{\equal{\cdtype}{batt}}{
  \placerefvalH{-1.25}{0}{1.25}{-3.25}{0}{3.25}
  #1
  \draw [cdmedlines] (-0.45, -2) -- (-0.45, 2);
  \draw [cdthicklines] (0.45, -1) -- (0.45, 1);
  \draw (-0.45, 0) -- (-1, 0) (0.45, 0) -- (1, 0);
 }{}
 \ifthenelse{\equal{\cdtype}{batt2}}{
  \placerefvalH{-2.25}{0}{2.25}{-3.25}{0}{3.25}
  #1
  \draw [cdmedlines] (-1.35, -2) -- (-1.35, 2) (0.45, -2) -- (0.45, 2);
  \draw [cdthicklines] (-0.45, -1) -- (-0.45, 1) (1.35, -1) -- (1.35, 1);
  \draw (-1.35, 0) -- (-2, 0) (-0.45, 0) -- (0.45, 0) (1.35, 0) -- (2, 0);
 }{}
 \ifthenelse{\equal{\cdtype}{battn}}{
  \placerefvalH{-2.75}{0}{2.75}{-3.25}{0}{3.25}
  #1
  \draw [cdmedlines] (-1.9, -2) -- (-1.9, 2) (1, -2) -- (1, 2);
  \draw [cdthicklines] (-1, -1) -- (-1, 1) (1.9, -1) -- (1.9, 1);
  \draw (-1.9, 0) -- (-3, 0) (-1, 0) -- (-0.6, 0) (-0.2, 0) -- (0.2, 0) (0.6, 0) -- (1, 0) (1.9, 0) -- (3, 0);
 }{}
 \ifthenelse{\equal{\cdtype}{+-}}{
  \placerefvalH{-2.25}{0}{2.25}{-3.25}{0}{3.25}
  #1
  \draw [cdmedlines] circle (2);
  \draw (-2, 0) -- (-3, 0) (2, 0) -- (3, 0);
  \cdplus{-1.1}{0}
  \cdminus{1.1}{0}
 }{}
 \ifthenelse{\equal{\cdtype}{->}}{
  \placerefvalH{-2.25}{0}{2.25}{-3.25}{0}{3.25}
  #1
  \draw [cdmedlines] circle (2);
  \draw (-2, 0) -- (-3, 0) (2, 0) -- (3, 0);
  \cdbigarrow[3]{-1.5}{0}{180}
 }{}
}
\newcommand{\othersrcR}[1]{
 \setstandardtextpos{ud}
 \ifthenelse{\equal{\cdtype}{batt}}{
  \placerefvalH{-1.25}{0}{1.25}{-3.25}{0}{3.25}
  #1
  \draw [cdthicklines] (-0.45, -1) -- (-0.45, 1);
  \draw [cdmedlines] (0.45, -2) -- (0.45, 2);
  \draw (-0.45, 0) -- (-1, 0) (0.45, 0) -- (1, 0);
 }{}
 \ifthenelse{\equal{\cdtype}{batt2}}{
  \placerefvalH{-2.25}{0}{2.25}{-3.25}{0}{3.25}
  #1
  \draw [cdthicklines] (-1.35, -1) -- (-1.35, 1) (0.45, -1) -- (0.45, 1);
  \draw [cdmedlines] (-0.45, -2) -- (-0.45, 2) (1.35, -2) -- (1.35, 2);
  \draw (-1.35, 0) -- (-2, 0) (-0.45, 0) -- (0.45, 0) (1.35, 0) -- (2, 0);
 }{}
 \ifthenelse{\equal{\cdtype}{battn}}{
  \placerefvalH{-2.75}{0}{2.75}{-3.25}{0}{3.25}
  #1
  \draw [cdthicklines] (-1.9, -1) -- (-1.9, 1) (1, -1) -- (1, 1);
  \draw [cdmedlines] (-1, -2) -- (-1, 2) (1.9, -2) -- (1.9, 2);
  \draw (-1.9, 0) -- (-3, 0) (-1, 0) -- (-0.6, 0) (-0.2, 0) -- (0.2, 0) (0.6, 0) -- (1, 0) (1.9, 0) -- (3, 0);
 }{}
 \ifthenelse{\equal{\cdtype}{+-}}{
  \placerefvalH{-2.25}{0}{2.25}{-3.25}{0}{3.25}
  #1
  \draw [cdmedlines] circle (2);
  \draw (-2, 0) -- (-3, 0) (2, 0) -- (3, 0);
  \cdminus{-1.1}{0}
  \cdplus{1.1}{0}
 }{}
 \ifthenelse{\equal{\cdtype}{->}}{
  \placerefvalH{-2.25}{0}{2.25}{-3.25}{0}{3.25}
  #1
  \draw [cdmedlines] circle (2);
  \draw (-2, 0) -- (-3, 0) (2, 0) -- (3, 0);
  \cdbigarrow[3]{1.5}{0}{0}
 }{}
}
\newcommand{\othersrcV}[1]{
 \setstandardtextpos{r}
 \ifthenelse{\equal{\cdtype}{o}}{
  \placerefvalV{-2.5}{0}{2.5}{-3}{0}{3}
  #1
  \draw [cdmedlines] circle (2);
  \draw (0, -2) -- (0, -3) (0, 2) -- (0, 3);
 }{}
 \ifthenelse{\equal{\cdtype}{oo}}{
  \placerefvalV{-2.25}{0}{2.25}{-3.25}{0}{3.25}
  #1
  \draw [cdmedlines] (0, -0.8) circle (1.6) (0, 0.8) circle (1.6);
  \draw (0, -2.4) -- (0, -3) (0, 2.4) -- (0, 3);
 }{}
 \ifthenelse{\equal{\cdtype}{()}}{
  \placerefvalV{-2.5}{0}{2.5}{-3}{0}{3}
  #1
  \draw [cdmedlines] (-1.8, -0.4) arc (-180 : 0 : 1.8) (1.8, 0.4) arc (0 : 180 : 1.8);
  \draw (0, -2.2) -- (0, -3) (0, 2.2) -- (0, 3);
 }{}
}
\newcommand{\othersrcU}[1]{
 \setstandardtextpos{r}
 \ifthenelse{\equal{\cdtype}{batt}}{
  \placerefvalV{-2.5}{0}{2.5}{-1.75}{0}{1.75}
  #1
  \draw [cdthicklines] (-1, -0.45) -- (1, -0.45);
  \draw [cdmedlines] (-2, 0.45) -- (2, 0.45);
  \draw (0, -0.45) -- (0, -1) (0, 0.45) -- (0, 1);
 }{}
 \ifthenelse{\equal{\cdtype}{batt2}}{
  \placerefvalV{-2.5}{0}{2.5}{-2.75}{0}{2.75}
  #1
  \draw [cdthicklines] (-1, -1.35) -- (1, -1.35) (-1, 0.45) -- (1, 0.45);
  \draw [cdmedlines] (-2, -0.45) -- (2, -0.45) (-2, 1.35) -- (2, 1.35);
  \draw (0, -1.35) -- (0, -2) (0, -0.45) -- (0, 0.45) (0, 1.35) -- (0, 2);
 }{}
 \ifthenelse{\equal{\cdtype}{battn}}{
  \placerefvalV{-2.5}{0}{2.5}{-3.25}{0}{3.25}
  #1
  \draw [cdthicklines] (-1, -1.9) -- (1, -1.9) (-1, 1) -- (1, 1);
  \draw [cdmedlines] (-2, -1) -- (2, -1) (-2, 1.9) -- (2, 1.9);
  \draw (0, -1.9) -- (0, -3) (0, -1) -- (0, -0.6) (0, -0.2) -- (0, 0.2) (0, 0.6) -- (0, 1) (0, 1.9) -- (0, 3);
 }{}
 \ifthenelse{\equal{\cdtype}{+-}}{
  \placerefvalV{-2.5}{0}{2.5}{-3}{0}{3}
  #1
  \draw [cdmedlines] circle (2);
  \draw (0, -2) -- (0, -3) (0, 2) -- (0, 3);
  \cdminus{0}{-1.1}
  \cdplus{0}{1.1}
 }{}
 \ifthenelse{\equal{\cdtype}{->}}{
  \placerefvalV{-2.5}{0}{2.5}{-3}{0}{3}
  #1
  \draw [cdmedlines] circle (2);
  \draw (0, -2) -- (0, -3) (0, 2) -- (0, 3);
  \cdbigarrow[3]{0}{1.5}{90}
 }{}
}
\newcommand{\othersrcD}[1]{
 \setstandardtextpos{r}
 \ifthenelse{\equal{\cdtype}{batt}}{
  \placerefvalV{-2.5}{0}{2.5}{-1.75}{0}{1.75}
  #1
  \draw [cdmedlines] (-2, -0.45) -- (2, -0.45);
  \draw [cdthicklines] (-1, 0.45) -- (1, 0.45);
  \draw (0, -0.45) -- (0, -1) (0, 0.45) -- (0, 1);
 }{}
 \ifthenelse{\equal{\cdtype}{batt2}}{
  \placerefvalV{-2.5}{0}{2.5}{-2.75}{0}{2.75}
  #1
  \draw [cdmedlines] (-2, -1.35) -- (2, -1.35) (-2, 0.45) -- (2, 0.45);
  \draw [cdthicklines] (-1, -0.45) -- (1, -0.45) (-1, 1.35) -- (1, 1.35);
  \draw (0, -1.35) -- (0, -2) (0, -0.45) -- (0, 0.45) (0, 1.35) -- (0, 2);
 }{}
 \ifthenelse{\equal{\cdtype}{battn}}{
  \placerefvalV{-2.5}{0}{2.5}{-3.25}{0}{3.25}
  #1
  \draw [cdmedlines] (-2, -1.9) -- (2, -1.9) (-2, 1) -- (2, 1);
  \draw [cdthicklines] (-1, -1) -- (1, -1) (-1, 1.9) -- (1, 1.9);
  \draw (0, -1.9) -- (0, -3) (0, -1) -- (0, -0.6) (0, -0.2) -- (0, 0.2) (0, 0.6) -- (0, 1) (0, 1.9) -- (0, 3);
 }{}
 \ifthenelse{\equal{\cdtype}{+-}}{
  \placerefvalV{-2.5}{0}{2.5}{-3}{0}{3}
  #1
  \draw [cdmedlines] circle (2);
  \draw (0, -2) -- (0, -3) (0, 2) -- (0, 3);
  \cdplus{0}{-1.1}
  \cdminus{0}{1.1}
 }{}
 \ifthenelse{\equal{\cdtype}{->}}{
  \placerefvalV{-2.5}{0}{2.5}{-3}{0}{3}
  #1
  \draw [cdmedlines] circle (2);
  \draw (0, -2) -- (0, -3) (0, 2) -- (0, 3);
  \cdbigarrow[3]{0}{-1.5}{-90}
 }{}
}
% Measurement device
\newcommand{\measdev}[6][]{
 \prepareelement{UI}{}{#4}{#5}{#6}
 \begin{scope}[shift = {(#2, #3)}]
  \expandafter\csname measdev\cdorient\endcsname{#1}
  \drawrefval
 \end{scope}
}
\newcommand{\measdevH}[1]{
 \setstandardtextpos{ud}
 \placerefvalH{-2.25}{0}{2.25}{-3.25}{0}{3.25}
 #1
 \draw [cdmedlines] circle (2);
 \draw (-2, 0) -- (-3, 0) (2, 0) -- (3, 0);
}
\newcommand{\measdevV}[1]{
 \setstandardtextpos{r}
 \placerefvalV{-2.5}{0}{2.5}{-3}{0}{3}
 #1
 \draw [cdmedlines] circle (2);
 \draw (0, -2) -- (0, -3) (0, 2) -- (0, 3);
}
% Additional wires
\let\wireelemUIsrcmeas=\wireelemUI
\renewcommand{\wireelemUI}[2]{
 \ifthenelse{\equal{#1}{L}}{
  \ifthenelse{\equal{\cdtype}{batt}}{\begin{scope}[shift = {(2, 0)}]}{}
  \ifthenelse{\equal{\cdtype}{batt2}}{\begin{scope}[shift = {(1, 0)}]}{}
 }{}
 \ifthenelse{\equal{#1}{R}}{
  \ifthenelse{\equal{\cdtype}{batt}}{\begin{scope}[shift = {(-2, 0)}]}{}
  \ifthenelse{\equal{\cdtype}{batt2}}{\begin{scope}[shift = {(-1, 0)}]}{}
 }{}
 \ifthenelse{\equal{#1}{U}}{
  \ifthenelse{\equal{\cdtype}{batt}}{\begin{scope}[shift = {(0, -2)}]}{}
  \ifthenelse{\equal{\cdtype}{batt2}}{\begin{scope}[shift = {(0, -1)}]}{}
 }{}
 \ifthenelse{\equal{#1}{D}}{
  \ifthenelse{\equal{\cdtype}{batt}}{\begin{scope}[shift = {(0, 2)}]}{}
  \ifthenelse{\equal{\cdtype}{batt2}}{\begin{scope}[shift = {(0, 1)}]}{}
 }{}
 \wireelemUIsrcmeas{#1}{#2}
 \ifthenelse{\equal{\cdtype}{batt}\or\equal{\cdtype}{batt2}}{\end{scope}}{}
}
% Signal symbols
\newcommand{\sigsym}[1]{
 \ifthenelse{\equal{#1}{cos}}{
  \draw plot [smooth] coordinates {(-1.166667, -0.606218) (-1, -0.7) (-0.833333, -0.606218) (-0.666667, -0.35) (-0.5, 0)
   (-0.333333, 0.35) (-0.166667, 0.606218) (0, 0.7) (0.166667, 0.606218) (0.333333, 0.35) (0.5, 0) (0.666667, -0.35)
   (0.833333, -0.606218) (1, -0.7) (1.166667, -0.606218)};
 }{}
 \ifthenelse{\equal{#1}{-cos}}{
  \draw plot [smooth] coordinates {(-1.166667, 0.606218) (-1, 0.7) (-0.833333, 0.606218) (-0.666667, 0.35) (-0.5, 0)
   (-0.333333, -0.35) (-0.166667, -0.606218) (0, -0.7) (0.166667, -0.606218) (0.333333, -0.35) (0.5, 0) (0.666667, 0.35)
   (0.833333, 0.606218) (1, 0.7) (1.166667, 0.606218)};
 }{}
 \ifthenelse{\equal{#1}{cos>}}{
  \draw plot [smooth] coordinates {(-1.166667, 0.35) (-1, 0) (-0.833333, -0.35) (-0.666667, -0.606218) (-0.5, -0.7)
   (-0.333333, -0.606218) (-0.166667, -0.35) (0, 0) (0.166667, 0.35) (0.333333, 0.606218) (0.5, 0.7)
   (0.666667, 0.606218) (0.833333, 0.35) (1, 0) (1.166667, -0.35)};
 }{}
 \ifthenelse{\equal{#1}{-cos>}}{
  \draw plot [smooth] coordinates {(-1.166667, -0.35) (-1, 0) (-0.833333, 0.35) (-0.666667, 0.606218) (-0.5, 0.7)
   (-0.333333, 0.606218) (-0.166667, 0.35) (0, 0) (0.166667, -0.35) (0.333333, -0.606218) (0.5, -0.7)
   (0.666667, -0.606218) (0.833333, -0.35) (1, 0) (1.166667, 0.35)};
 }{}
 \ifthenelse{\equal{#1}{rec}}{
  \draw (-1.166667, -0.7) -- (-0.5, -0.7) -- (-0.5, 0.7) -- (0.5, 0.7) -- (0.5, -0.7) -- (1.166667, -0.7);
 }{}
 \ifthenelse{\equal{#1}{-rec}}{
  \draw (-1.166667, 0.7) -- (-0.5, 0.7) -- (-0.5, -0.7) -- (0.5, -0.7) -- (0.5, 0.7) -- (1.166667, 0.7);
 }{}
 \ifthenelse{\equal{#1}{rec>}}{
  \draw (-1.166667, 0.7) -- (-1, 0.7) -- (-1, -0.7) -- (0, -0.7) -- (0, 0.7) -- (1, 0.7) -- (1, -0.7)
   -- (1.166667, -0.7);
 }{}
 \ifthenelse{\equal{#1}{-rec>}}{
  \draw (-1.166667, -0.7) -- (-1, -0.7) -- (-1, 0.7) -- (0, 0.7) -- (0, -0.7) -- (1, -0.7) -- (1, 0.7)
   -- (1.166667, 0.7);
 }{}
 \ifthenelse{\equal{#1}{tri}}{
  \draw (-1.166667, -0.466667) -- (-1, -0.7) -- (0, 0.7) -- (1, -0.7) -- (1.166667, -0.466667);
 }{}
 \ifthenelse{\equal{#1}{-tri}}{
  \draw (-1.166667, 0.466667) -- (-1, 0.7) -- (0, -0.7) -- (1, 0.7) -- (1.166667, 0.466667);
 }{}
 \ifthenelse{\equal{#1}{tri>}}{
  \draw (-1.166667, 0.233333) -- (-0.5, -0.7) -- (0.5, 0.7) -- (1.166667, -0.233333);
 }{}
 \ifthenelse{\equal{#1}{-tri>}}{
  \draw (-1.166667, -0.233333) -- (-0.5, 0.7) -- (0.5, -0.7) -- (1.166667, 0.233333);
 }{}
 \ifthenelse{\equal{#1}{saw}}{
  \draw (-1.166667, 0.583333) -- (-1, 0.7) -- (-1, -0.7) -- (1, 0.7) -- (1, -0.7) -- (1.166667, -0.583333);
 }{}
 \ifthenelse{\equal{#1}{-saw}}{
  \draw (-1.166667, -0.583333) -- (-1, -0.7) -- (-1, 0.7) -- (1, -0.7) -- (1, 0.7) -- (1.166667, 0.583333);
 }{}
 \ifthenelse{\equal{#1}{saw>}}{
  \draw (-1.166667, -0.116667) -- (0, 0.7) -- (0, -0.7) -- (1.166667, 0.116667);
 }{}
 \ifthenelse{\equal{#1}{-saw>}}{
  \draw (-1.166667, 0.116667) -- (0, -0.7) -- (0, 0.7) -- (1.166667, -0.116667);
 }{}
}
% Polarity
\newcommand{\polarity}[1]{
 \ifthenelse{\equal{#1}{UL}}{\cdoplus{-2.75}{1.25}\cdominus{2.75}{1.25}}{}
 \ifthenelse{\equal{#1}{UR}}{\cdoplus{2.75}{1.25}\cdominus{-2.75}{1.25}}{}
 \ifthenelse{\equal{#1}{DL}}{\cdoplus{-2.75}{-1.25}\cdominus{2.75}{-1.25}}{}
 \ifthenelse{\equal{#1}{DR}}{\cdoplus{2.75}{-1.25}\cdominus{-2.75}{-1.25}}{}
 \ifthenelse{\equal{#1}{LU}}{\cdoplus{-1.25}{2.75}\cdominus{-1.25}{-2.75}}{}
 \ifthenelse{\equal{#1}{LD}}{\cdoplus{-1.25}{-2.75}\cdominus{-1.25}{2.75}}{}
 \ifthenelse{\equal{#1}{RU}}{\cdoplus{1.25}{2.75}\cdominus{1.25}{-2.75}}{}
 \ifthenelse{\equal{#1}{RD}}{\cdoplus{1.25}{-2.75}\cdominus{1.25}{2.75}}{}
}
% Measurement unit
\newcommand{\measunit}[1]{{\sffamily\cdputtext{0}{0}{c}{#1}}}
